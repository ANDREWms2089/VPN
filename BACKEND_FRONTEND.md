# üîó –°–≤—è–∑—å Backend –∏ Frontend

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### Backend (Node.js/Express)

1. **–£–ª—É—á—à–µ–Ω API —Å–µ—Ä–≤–µ—Ä:**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Ä–µ–∞–ª—å–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞, –∑–∞—Ç–µ–º –ø–æ ping)

2. **API Endpoints:**
   - `GET /api/servers` - —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π)
   - `GET /api/servers/:id` - –¥–µ—Ç–∞–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞
   - `GET /api/servers/:id/ping` - –ø—Ä–æ–≤–µ—Ä–∫–∞ ping
   - `POST /api/connection` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
   - `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

3. **–£–ª—É—á—à–µ–Ω–∏—è:**
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ (`success`, `error`, `message`)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 404 –∏ 500
   - CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ (–≤ production —É–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ)

### Frontend (Flutter)

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ URL –±—ç–∫–µ–Ω–¥–∞:**
   - Android —ç–º—É–ª—è—Ç–æ—Ä: `http://10.0.2.2:3000/api`
   - iOS —Å–∏–º—É–ª—è—Ç–æ—Ä / Desktop: `http://localhost:3000/api`
   - Web: `http://localhost:3000/api`

2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É API:**
   - `useMockData = false` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –±—ç–∫–µ–Ω–¥
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç API
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

3. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º:**
   - –ï—Å–ª–∏ –±—ç–∫–µ–Ω–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏ `useMockData = true`, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ï—Å–ª–∏ `useMockData = false`, –æ—à–∏–±–∫–∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–¢–µ—Ä–º–∏–Ω–∞–ª 1 - Backend:**
```bash
cd backend
npm install
npm run dev
```

2. **–¢–µ—Ä–º–∏–Ω–∞–ª 2 - Frontend:**
```bash
flutter pub get
flutter run
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend:
```bash
curl http://localhost:3000/health
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤:
```bash
curl http://localhost:3000/api/servers
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –ó–∞–ø—Ä–æ—Å —Å–µ—Ä–≤–µ—Ä–æ–≤

**Request:**
```
GET /api/servers
```

**Response:**
```json
{
  "success": true,
  "count": 3,
  "servers": [
    {
      "id": "nl-reality-1",
      "name": "–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã 10–ì–±–∏—Ç/—Å",
      "address": "10.nl.vpnpplvpn.top",
      "port": 443,
      "uuid": "58a6ce24-fe00-4a0e-8c69-a3381f5a5da1",
      ...
    }
  ]
}
```

### Ping —Å–µ—Ä–≤–µ—Ä–∞

**Request:**
```
GET /api/servers/nl-reality-1/ping
```

**Response:**
```json
{
  "success": true,
  "ping": 35,
  "serverId": "nl-reality-1",
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ URL –±—ç–∫–µ–Ω–¥–∞

–í `lib/services/api_service.dart`:

```dart
static String get baseUrl {
  // –î–ª—è production –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π URL
  if (!kIsWeb && Platform.isAndroid) {
    return 'http://10.0.2.2:3000/api';
  }
  return 'http://localhost:3000/api';
  // –ò–ª–∏ –¥–ª—è production:
  // return 'https://your-backend-api.com/api';
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

```dart
static const bool useMockData = true;
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Backend

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   curl http://localhost:3000/health
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ –ª–æ–≥–∞—Ö Flutter:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ DevTools
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

3. **–î–ª—è Android —ç–º—É–ª—è—Ç–æ—Ä–∞:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `10.0.2.2:3000`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —ç–º—É–ª—è—Ç–æ—Ä –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ç–∏

4. **–î–ª—è iOS —Å–∏–º—É–ª—è—Ç–æ—Ä–∞:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `localhost:3000`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ —Å–∏–º—É–ª—è—Ç–æ—Ä–∞

### Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ Backend –∏ Frontend —Å–≤—è–∑–∞–Ω—ã
2. ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
4. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å rate limiting
5. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –¥–ª—è production
6. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –±—ç–∫–µ–Ω–¥ –≤–º–µ—Å—Ç–æ –º–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö!

